---
layout: post
title:  "Jekyll, part 5: Adding a categories page"
date:   2019-09-26 21:25:00 +0200 # Update when done
categories: [jekyll, liquid]
---
## Preface
---
While the basic theme, *minima*, of a new standard Jekyll site generated by `jekyll new site-name` is both nice and frugal, it is a bit, well, basic. One of the first things I thought it lacked was a page or list with the categories, or tags which in as far as Jekyll is concerned is pretty much the same. While many themes come with this functionality built-in, I thought it a welcome opportunity to get my hands dirty rather than just download a finished one and be none the wiser. Yes, the easier route would be to just use a plugin such as `jekyll-archives` and be done with it, but where is the fun in that?

## Adding categories
---
In order to add a post to a category, just add it to the post header and Jekyll will detect the categories when building the site.

```
---
layout: post
title:  "Adding categories to jekyll"
date:   2019-09-23 20:30:00 +0200
categories: jekyll
---
```

More that one category can be added by either seperating them by spaces

```
categories: jekyll liquid
```

or adding them as an array.

```
categories: [jekyll, liquid]
```

## The categories page
---
With the categories sorted we still need an categories overview page, so I've added a *categories.html* file the to project root folder. This file will serve as the category list and will eventually contain the template to generate it. The templating language used by Jekyll is [Liquid](https://jekyllrb.com/docs/liquid/) and though it works Liquid is **NOT** pretty in my opinion. Furthermore, I find that Jekyll itself and Jekyll's use of Liquid is poorly documented.

### Overall approach
---
In order to do this we need a plan and this will serve as a basic one.

>* get all categories for the site
>* sort them alphabetically in ascending order
>* for each category in categories
>   * display category name
>   * for each post in category
>       * display link to post

### Sitewide variables
---
Jekyll exposes a number of [sitewide variables](https://jekyllrb.com/docs/variables/) that are useful in this context. Namely the `site.categories` which it a collection of objects each representing a category. Each of these objects has a collection of posts and an attribute containing the category name. The post object again has attributes representing the post's title, category, url and such.

### The template
---
This is the contents of *categories.html* and it might look a bit wierd because it's a mix of HTML and Liquid. Create the file in the project root. Jekyll should detect this file automatically and add a link the index page. Now, a little explanation, `category.first` is the category name and `category.last` contains the category posts. I **REALLY** wish these attributes were better named. I have not been able to find these attributes documented offficially and this is just way too close to [tribal knowledge](https://en.wikipedia.org/wiki/Tribal_knowledge) and proves my earlier point about poor documentation.

```html
{% raw %}
<div id="archives">
    {% assign sorted_categories = site.categories | sort %}
    {% for category in sorted_categories %}
    <div>
        <h3 class="post-list-heading">{{ category | first }}</h3>
        <ul>
            {% for post in category.last %}
            <li>
                <a href="{{ post.url }}" class="page-link">{{ post.title }}</a>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endfor %}
</div>
{% endraw %}
```

Upload and enjoy.

The next part of the series, [Jekyll, part 6: Adding search functionality]({% post_url 2019-09-28-jekyll-part-6-adding-search-functionality %}), will focus on creating a search page using [Liquid](https://jekyllrb.com/docs/liquid/), [JavaScript](https://en.wikipedia.org/wiki/JavaScript) and [Lunr](https://lunrjs.com/).
